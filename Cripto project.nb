(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49034,       1040]
NotebookOptionsPosition[     48029,       1016]
NotebookOutlinePosition[     48431,       1032]
CellTagsIndexPosition[     48388,       1029]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"enc", "[", 
    RowBox[{"m_", ",", "g_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
    "m", " ", "is", " ", "the", " ", "message", " ", "you", " ", "want", " ", 
     "to", " ", 
     RowBox[{"encrypt", ".", " ", "g"}], " ", "and", " ", "n", " ", "are", 
     " ", "part", " ", "of", " ", "the", " ", "public", " ", "key"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GCD", "[", 
          RowBox[{"r", ",", "n"}], "]"}], " ", "\[NotEqual]", " ", "1"}], ",",
         " ", 
        RowBox[{"r", " ", "=", " ", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}], "]"}]}]}], "]"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"encontrar", " ", "um", " ", "r", " ", "qualquer"}], ",", " ", 
        RowBox[{
        "mas", " ", "tem", " ", "que", " ", "ser", " ", "coprimo", " ", "com",
          " ", "n"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PowerMod", "[", 
           RowBox[{"g", ",", "m", ",", 
            RowBox[{"n", "^", "2"}]}], "]"}], "*", 
          RowBox[{"PowerMod", "[", 
           RowBox[{"r", ",", "n", ",", 
            RowBox[{"n", "^", "2"}]}], "]"}]}], ",", 
         RowBox[{"n", "^", "2"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dec", "[", 
   RowBox[{"c_", ",", "lambda_", ",", "mew_", ",", "n_"}], "]"}], ":=", " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "c", " ", "is", " ", "the", " ", "cyphertext", " ", "you", " ", "want", 
     " ", "to", " ", "decrypt"}], ",", " ", 
    RowBox[{
    "lambda", " ", "and", " ", "mew", " ", "are", " ", "part", " ", "of", " ",
      "the", " ", "private", " ", "key"}], ",", " ", 
    RowBox[{
    "n", " ", "is", " ", "part", " ", "of", " ", "the", " ", "public", " ", 
     "key"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", " ", "=", " ", 
      RowBox[{"PowerMod", "[", 
       RowBox[{"c", ",", "lambda", ",", 
        RowBox[{"n", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", " ", "=", " ", 
      RowBox[{"Quotient", "[", 
       RowBox[{
        RowBox[{"a", "-", "1"}], ",", "n"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"a", "*", "mew"}], ",", "n"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], " "}]}], "Input",
 CellChangeTimes->{{3.7963926417762747`*^9, 3.796392647886902*^9}, {
  3.7963928348906174`*^9, 3.7963928374268675`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"8b1b0b23-2e0d-44c4-a31e-096b9cda444f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Soma", "[", 
     RowBox[{"fe_", ",", "ge_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", "=", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", 
      RowBox[{"(*", 
       RowBox[{
       "soma", " ", "de", " ", "dois", " ", "polin\[OAcute]mios", " ", 
        "encriptados"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"r", ",", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fe", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"ge", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"Power", "[", 
              RowBox[{"n", ",", "2"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "fe", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "r"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Produto", "[", 
     RowBox[{"fe_", ",", "g_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "=", 
         RowBox[{"{", "}"}]}], ",", "rj"}], "}"}], ",", " ", 
      RowBox[{"(*", 
       RowBox[{
       "produto", " ", "de", " ", "um", " ", "polin\[OAcute]mio", " ", 
        "encriptado", " ", "por", " ", "um", " ", "n\[ATilde]o", " ", 
        "encriptado"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"r", ",", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"Product", "[", 
              RowBox[{
               RowBox[{"PowerMod", "[", 
                RowBox[{
                 RowBox[{"fe", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "j", "+", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"g", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"Power", "[", 
                  RowBox[{"n", ",", "2"}], "]"}]}], "]"}], " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "product", " ", "\[EAcute]", " ", "a", " ", "soma", " ", 
                  "dos", " ", "meni\[NTilde]os"}], ",", " ", 
                 RowBox[{
                 "o", " ", "power", " ", "mod", " ", "\[EAcute]", " ", "o", 
                  " ", "produto", " ", "fe", "*", "g"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"i", "-", 
                    RowBox[{"Length", "[", "g", "]"}], "+", "1"}]}], "]"}], 
                 ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{"i", ",", 
                   RowBox[{"Length", "[", "fe", "]"}]}], "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Power", "[", 
              RowBox[{"n", ",", "2"}], "]"}]}], "]"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "fe", "]"}], "+", 
            RowBox[{"Length", "[", "g", "]"}], "-", "1"}]}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "r"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rcoef", "[", 
   RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"p", "*", "q"}]}], ",", "x"}], "}"}], ",", " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "esta", " ", "fun\[CCedilla]\[ATilde]o", " ", "devolver", " ", "um", 
       " ", "n\[UAcute]mero", " ", 
       RowBox[{"aleat\[OAcute]rio", ".", " ", "tem"}], " ", "que", " ", "ser",
        " ", "coprimo", " ", "com", " ", "n"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"porque", " ", "se", " ", "n\[ATilde]o", " ", "for"}], 
        "..."}], " ", "contem", " ", "a", " ", "informa\[CCedilla]ao", " ", 
       "de", " ", "uma", " ", "raiz", " ", "nao", " ", "trivial", " ", "de", 
       " ", "n"}], ",", " ", 
      RowBox[{"e", " ", "consequentemente"}], ",", " ", 
      RowBox[{
      "de", " ", "como", " ", "destruir", " ", "o", " ", "sistema", " ", 
       "criptografico"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"RandomInteger", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"GCD", "[", 
         RowBox[{"x", ",", "n"}], "]"}], "\[NotEqual]", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{"RandomInteger", "[", "n", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "x", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7965685950218706`*^9, 3.796568625871909*^9}, {
   3.7965686592059007`*^9, 3.7965689574663553`*^9}, {3.796568998491441*^9, 
   3.7965690126380982`*^9}, {3.7965690491899805`*^9, 3.796569253280365*^9}, {
   3.7965695176692142`*^9, 3.7965695302350655`*^9}, 3.796569650528617*^9, {
   3.796569691005908*^9, 3.7965696972663956`*^9}, {3.7965697649858646`*^9, 
   3.7965697660820923`*^9}, {3.7965698104774165`*^9, 
   3.7965698453864326`*^9}, {3.7965699419365587`*^9, 3.7965699668074865`*^9}, 
   3.7965700922793083`*^9, {3.7965701804780483`*^9, 3.7965701973546023`*^9}, {
   3.7965703023445945`*^9, 3.796570331648118*^9}, {3.79657038282224*^9, 
   3.7965703828710785`*^9}, {3.7965704947726927`*^9, 
   3.7965705046014605`*^9}, {3.7965705808264575`*^9, 3.796570583163078*^9}, {
   3.796570614056724*^9, 3.7965706741056795`*^9}, {3.796570780247409*^9, 
   3.7965708334433603`*^9}, {3.796570870507353*^9, 3.796570883238099*^9}, {
   3.796571153380581*^9, 3.7965711982155385`*^9}, {3.796571245299693*^9, 
   3.796571321143199*^9}, {3.7965713663593917`*^9, 3.796571370353572*^9}, {
   3.796571440586087*^9, 3.7965714680353384`*^9}, {3.7965715097403693`*^9, 
   3.7965715476008453`*^9}, {3.796571625053686*^9, 3.7965716768846817`*^9}, {
   3.796573119921425*^9, 3.7965731476237836`*^9}, {3.796573211700245*^9, 
   3.7965732118069587`*^9}, 3.7965732940770097`*^9, {3.796573359970318*^9, 
   3.7965733694627466`*^9}, {3.7965735379853125`*^9, 3.79657355373778*^9}, {
   3.796573593666116*^9, 3.7965735937379255`*^9}, 3.7965736662696037`*^9, {
   3.796573712129283*^9, 3.796573714243995*^9}, {3.7965738016183558`*^9, 
   3.7965738040938244`*^9}, {3.7965741396332197`*^9, 
   3.7965741401772985`*^9}, {3.7965760917257996`*^9, 
   3.7965761302999215`*^9}, {3.796741623079626*^9, 3.7967417580045147`*^9}, {
   3.7992180333311777`*^9, 3.799218109303301*^9}, {3.7992227984386225`*^9, 
   3.799222826049253*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"9300f5ee-0bd5-47c4-9e96-139677f1a78b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PPSO", "[", 
   RowBox[{"L_", ",", "p_", ",", "q_", ",", "c_"}], "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "p", " ", "e", " ", "q", " ", "s\[ATilde]o", " ", "os", " ", "numeros", 
     " ", 
     RowBox[{"primos", ".", " ", "L"}], " ", "\[EAcute]", " ", "uma", " ", 
     "lista", " ", "com", " ", "os", " ", "conjuntos", " ", "das", " ", 
     RowBox[{"pessoas", ".", " ", "c"}], " ", "\[EAcute]", " ", "o", " ", 
     "\"\<c\>\"", " ", "no", " ", "protocolo"}], ",", " ", 
    RowBox[{
    "o", " ", "numero", " ", "maximo", " ", "de", " ", "pessoas", " ", "que", 
     " ", "estao", " ", "a", " ", "trabalhar", " ", "juntas", " ", "para", 
     " ", "terem", " ", "informa\[CCedilla]ao", " ", "extra"}]}], "*)"}], 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lambda", ",", "mew", ",", 
      RowBox[{"n", "=", 
       RowBox[{"p", "*", "q"}]}], ",", "g", ",", "a", ",", "w", ",", 
      RowBox[{"F", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"EF", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "L", "]"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"Phi", "=", 
       RowBox[{"{", "}"}]}], ",", "ri", ",", "phii", ",", "P", ",", "dp", ",",
       "DP", ",", 
      RowBox[{"int", "=", 
       RowBox[{"{", "}"}]}], ",", "rai", ",", "daux"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "setup", " ", "das", " ", "coisas", " ", "do", " ", "sistema", " ", 
      "criptografico"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lambda", " ", "=", " ", 
      RowBox[{"LCM", "[", 
       RowBox[{
        RowBox[{"p", "-", "1"}], ",", 
        RowBox[{"q", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", " ", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"n", "^", "2"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"w", " ", "=", " ", "True"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GCD", "[", 
          RowBox[{"g", ",", 
           RowBox[{"n", "^", "2"}]}], "]"}], "\[NotEqual]", " ", "1"}], " ", "||",
         "  ", "w"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", " ", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Power", "[", 
             RowBox[{"n", ",", "2"}], "]"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a", " ", "=", " ", 
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PowerMod", "[", 
             RowBox[{"g", ",", "lambda", ",", 
              RowBox[{"Power", "[", 
               RowBox[{"n", ",", "2"}], "]"}]}], "]"}], " ", "-", " ", "1"}], 
           ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"GCD", "[", 
            RowBox[{"a", ",", "n"}], "]"}], "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"mew", " ", "=", " ", 
            RowBox[{"PowerMod", "[", 
             RowBox[{"a", ",", 
              RowBox[{"-", "1"}], ",", "n"}], "]"}]}], ";", 
           RowBox[{"w", " ", "=", " ", "False"}]}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"F", ",", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", 
             RowBox[{
              RowBox[{"L", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"L", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "L", "]"}]}], "}"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "F", " ", "tem", " ", "a", " ", "informa\[CCedilla]ao", " ", "das", 
        " ", "listas"}], ",", " ", 
       RowBox[{
       "mas", " ", "na", " ", "forma", " ", "de", " ", "polinomio"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"enc", "[", 
             RowBox[{"#", ",", "g", ",", "n"}], "]"}], "&"}], ",", 
           RowBox[{"CoefficientList", "[", 
            RowBox[{
             RowBox[{"F", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}]}], "]"}]}], 
        ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "f", " ", "\[EAcute]", " ", "a", " ", "lista", " ", "dos", " ", 
          "coeficientes", " ", "dos", " ", "polinomios", " ", "encriptados"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{
            RowBox[{"EF", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"Length", "[", "L", "]"}]}], "]"}], "+", "1"}], 
              "]"}], "]"}], ",", "f"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "i", ",", 
            RowBox[{"i", "+", "c"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "L", "]"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "cada", " ", "pessoa", " ", "vai", " ", "mandar", " ", "a", " ", "sua",
         " ", "lista", " ", "de", " ", "coeficientes", " ", "do", " ", "seu", 
        " ", "polinomio", " ", "encriptado", " ", "para", " ", "as", " ", 
        "proximas", " ", "c", " ", 
        RowBox[{"pessoas", ".", " ", "EF"}], " ", "\[EAcute]", " ", "uma", 
        " ", "lista", " ", "que"}], ",", " ", 
       RowBox[{"em", " ", "cada", " ", "elemento"}], ",", " ", 
       RowBox[{
       "tem", " ", "os", " ", "coeficientes", " ", "dos", " ", "polinomios", 
        " ", "encriptados", " ", "que", " ", "ele", " ", "recebeu"}], ",", 
       " ", 
       RowBox[{"proviniente", " ", "dos", " ", "c", " ", "participantes", " ", 
        RowBox[{"anteriores", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ri", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"ri", ",", 
            RowBox[{"CoefficientList", "[", 
             RowBox[{
              RowBox[{"Product", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", 
                  RowBox[{"Rcoef", "[", 
                   RowBox[{"p", ",", "q"}], "]"}]}], ")"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"L", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              ",", "x"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"c", "+", "1"}]}], "}"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Para", " ", "cada", " ", "pessoa"}], ",", " ", 
          RowBox[{
           RowBox[{"escolher", " ", "c"}], "+", 
           RowBox[{
           "1", " ", "polin\[OAcute]mios", " ", "aleat\[OAcute]rios", " ", 
            "de", " ", "grau", " ", "igual", " ", "aos", " ", 
            "polin\[OAcute]mios"}]}], ",", " ", 
          RowBox[{
          "o", " ", "comprimento", " ", "dos", " ", "conjuntos", " ", "que", 
           " ", "queremos", " ", "intercetar"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
           "ri", " ", "tem", " ", "a", " ", "informa\[CCedilla]ao", " ", 
            "desses", " ", "c"}], "+", 
           RowBox[{"1", " ", "polinomios"}]}], ",", " ", 
          RowBox[{"da", " ", "pessoa", " ", "i"}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"phii", "=", 
         RowBox[{"Produto", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"EF", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"ri", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "n"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"phii", "=", 
           RowBox[{"Soma", "[", 
            RowBox[{"phii", ",", 
             RowBox[{"Produto", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"EF", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"ri", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "n"}], "]"}], ",", "n"}],
             "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", "c"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "phii", " ", "\[EAcute]", " ", "polin\[OAcute]mio", " ", "que", " ", 
          "\[EAcute]", " ", "a", " ", "encripta\[CCedilla]\[ATilde]o", " ", 
          "do", " ", "polinomio", " ", "que", " ", "representa", " ", "o", 
          " ", "conjunto", " ", "que", " ", "\[EAcute]", " ", "a", " ", 
          "interce\[CCedilla]\[ATilde]o", " ", "do", " ", "conjunto", " ", 
          "da", " ", "pessoa", " ", "i", " ", "com", " ", "os", " ", "c", " ", 
          RowBox[{"anteriores", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"Phi", ",", "phii"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "EF", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"phi", " ", "contem", " ", "a", " ", "informa\[CCedilla]ao"}], 
       ",", " ", 
       RowBox[{"para", " ", "cada", " ", "pessoa"}], ",", " ", 
       RowBox[{
       "do", " ", "seu", " ", "conjunto", " ", "interceptado", " ", "com", 
        " ", "os", " ", "c", " ", 
        RowBox[{"anteriores", ".", " ", "Essa"}], " ", "informa\[CCedilla]ao",
         " ", "vem", " ", "na", " ", "forma", " ", "de", " ", "coeficientes", 
        " ", "dum", " ", "polinomio", " ", 
        RowBox[{"encriptado", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"Length", "[", "L", "]"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
      "P", " ", "\[EAcute]", " ", "a", " ", "lista", " ", "da", " ", "soma", 
       " ", "iterativa", " ", "dos", " ", "polin\[OAcute]mios", " ", 
       "encriptados"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"Phi", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "=", 
        RowBox[{"Soma", "[", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", 
            RowBox[{"j", "-", "1"}], "]"}], "]"}], ",", 
          RowBox[{"Phi", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "n"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", 
         RowBox[{"Length", "[", "L", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "O", " ", "polin\[OAcute]mio", " ", "obtido", " ", "na", " ", 
        "itera\[CCedilla]\[ATilde]o", " ", "final"}], ",", " ", 
       RowBox[{"P", "[", 
        RowBox[{"[", 
         RowBox[{"Length", "[", "L", "]"}], "]"}], "]"}], ",", " ", 
       RowBox[{
       "\[EAcute]", " ", "a", " ", "soma", " ", "final", " ", "de", " ", 
        "todos", " ", "os", " ", "polin\[OAcute]mios"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dp", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dec", "[", 
          RowBox[{"#", ",", "lambda", ",", "mew", ",", "n"}], "]"}], "&"}], 
        ",", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "L", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     " ", 
     RowBox[{"(*", 
      RowBox[{
      "decriptamos", " ", "o", " ", "polinomio", " ", "que", " ", 
       "representa", " ", "a", " ", "interce\[CCedilla]\[ATilde]o", " ", "de",
        " ", "todos"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DP", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"Reverse", "[", "dp", "]"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rai", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"daux", "=", "DP"}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "devolve", " ", "as", " ", "ra\[IAcute]zes", " ", "que", " ", "cada",
           " ", "pessoa", " ", "calcula"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"daux", "/.", 
                RowBox[{"{", 
                 RowBox[{"x", "\[Rule]", 
                  RowBox[{
                   RowBox[{"L", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], ",", "n"}], 
              "]"}], "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"rai", ",", 
               RowBox[{
                RowBox[{"L", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"daux", "=", 
              RowBox[{"FromDigits", "[", 
               RowBox[{
                RowBox[{"Reverse", "@", 
                 RowBox[{"CoefficientList", "[", 
                  RowBox[{
                   RowBox[{"PolynomialQuotient", "[", 
                    RowBox[{"daux", ",", 
                    RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{
                    RowBox[{"L", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ")"}], ",", "x"}], 
                    "]"}], ",", "x"}], "]"}]}], ",", "x"}], "]"}]}]}]}], 
           "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"L", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"int", ",", "rai"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "L", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "int", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796309769004184*^9, 3.796309785484181*^9}, {
   3.796309868735691*^9, 3.7963098818087854`*^9}, {3.796309944513193*^9, 
   3.7963100854775157`*^9}, {3.796310144837927*^9, 3.7963101461873293`*^9}, {
   3.7963102492472715`*^9, 3.796310265910155*^9}, {3.796310475331587*^9, 
   3.7963105178907447`*^9}, {3.7963107490544987`*^9, 3.796310789334581*^9}, 
   3.796311000667987*^9, {3.7963111121744633`*^9, 3.796311118938122*^9}, {
   3.7963111517983627`*^9, 3.796311202661414*^9}, {3.796311363541521*^9, 
   3.796311385292987*^9}, {3.7963114514152336`*^9, 3.796311452975452*^9}, {
   3.796311497151469*^9, 3.796311556362152*^9}, {3.796311636941927*^9, 
   3.796311792639251*^9}, {3.7963118535191207`*^9, 3.796312064178439*^9}, {
   3.796312160414914*^9, 3.7963121612487183`*^9}, {3.796312205523405*^9, 
   3.7963122482312546`*^9}, {3.796312308805393*^9, 3.7963124073361006`*^9}, {
   3.79631247574929*^9, 3.796312515657646*^9}, {3.796312550987278*^9, 
   3.7963125792966237`*^9}, {3.7963660652696667`*^9, 
   3.7963660746734953`*^9}, {3.7963661454061146`*^9, 
   3.7963661520044804`*^9}, {3.7963662299860644`*^9, 3.796366236386989*^9}, {
   3.796379787970451*^9, 3.796379860495702*^9}, {3.7963803778773828`*^9, 
   3.796380381242338*^9}, {3.796380444456648*^9, 3.796380450528675*^9}, {
   3.7963806775547395`*^9, 3.796380736896328*^9}, {3.79638145549145*^9, 
   3.796381484810721*^9}, {3.796381540012993*^9, 3.7963815617547016`*^9}, {
   3.7963820002637496`*^9, 3.796382007570318*^9}, {3.7963820677697*^9, 
   3.7963821510737715`*^9}, {3.7963922300319195`*^9, 
   3.7963922647114744`*^9}, {3.7963925765016537`*^9, 3.796392609983229*^9}, {
   3.7963929024072037`*^9, 3.7963929094943047`*^9}, {3.796393030200962*^9, 
   3.7963930411616306`*^9}, {3.796393143042389*^9, 3.796393155439261*^9}, {
   3.7963940842448053`*^9, 3.7963943114516973`*^9}, {3.7963943707911344`*^9, 
   3.7963943798678474`*^9}, {3.796394424056768*^9, 3.7963944252775097`*^9}, {
   3.7963945057006016`*^9, 3.796394533014612*^9}, {3.796394589945492*^9, 
   3.7963946023932514`*^9}, {3.7963946666275826`*^9, 3.796394673877206*^9}, {
   3.796394919327321*^9, 3.796394948774675*^9}, {3.796395201707754*^9, 
   3.796395234846202*^9}, {3.7963961136149693`*^9, 3.796396156484418*^9}, {
   3.796396282100787*^9, 3.7963963309412384`*^9}, {3.796396384650755*^9, 
   3.796396396459197*^9}, {3.7963964760225887`*^9, 3.7963965478047647`*^9}, 
   3.796396795036112*^9, {3.7963969329248385`*^9, 3.7963969364534445`*^9}, {
   3.796397426861949*^9, 3.796397427770521*^9}, {3.7963975203541555`*^9, 
   3.7963977369862757`*^9}, {3.796397825122732*^9, 3.7963978829322577`*^9}, {
   3.796397960141965*^9, 3.796397966086085*^9}, {3.7963980147111597`*^9, 
   3.7963980773666954`*^9}, {3.796398108454646*^9, 3.7963983843713565`*^9}, {
   3.7963984452177315`*^9, 3.7963984469401636`*^9}, {3.7964092816778154`*^9, 
   3.796409307367168*^9}, {3.7964095449206867`*^9, 3.79640954586217*^9}, {
   3.796413814436778*^9, 3.7964138182236905`*^9}, {3.796448082917031*^9, 
   3.796448100793271*^9}, {3.7964482400959177`*^9, 3.796448246338237*^9}, {
   3.7964510760552225`*^9, 3.7964511083529167`*^9}, {3.79645347878435*^9, 
   3.796453598828551*^9}, {3.796454018520979*^9, 3.796454037569081*^9}, {
   3.7964552738810353`*^9, 3.7964552793574467`*^9}, {3.796455805706423*^9, 
   3.7964558100827274`*^9}, {3.7964558438814106`*^9, 3.796455911340191*^9}, {
   3.7964560110247784`*^9, 3.796456087654046*^9}, {3.7964562537691507`*^9, 
   3.796456374655097*^9}, {3.796456536706925*^9, 3.7964565709145117`*^9}, {
   3.7964566175857697`*^9, 3.7964566340607796`*^9}, {3.7964566927130165`*^9, 
   3.7964567343458004`*^9}, 3.7964568555723624`*^9, {3.7964571585706673`*^9, 
   3.7964571587810783`*^9}, {3.7964572440343046`*^9, 
   3.7964573034429016`*^9}, {3.796464092666196*^9, 3.79646427362796*^9}, {
   3.7964643990229907`*^9, 3.7964644310647078`*^9}, {3.7964651448196926`*^9, 
   3.7964651761551094`*^9}, {3.7964652396538267`*^9, 3.796465328715844*^9}, {
   3.796465427282406*^9, 3.7964655578626156`*^9}, {3.7964659473961244`*^9, 
   3.7964659777296057`*^9}, {3.7964675850397778`*^9, 3.79646761642351*^9}, {
   3.7964678261210685`*^9, 3.796467848419319*^9}, 3.7964678953836946`*^9, {
   3.7964689729697757`*^9, 3.7964689848129*^9}, {3.796469020718359*^9, 
   3.796469023226643*^9}, {3.796566750525528*^9, 3.796566783720798*^9}, {
   3.7965668285898294`*^9, 3.796566898702424*^9}, {3.796567425288926*^9, 
   3.796567529866371*^9}, {3.7965676269354305`*^9, 3.796567647661065*^9}, {
   3.796567734962657*^9, 3.796567751259117*^9}, {3.7965679500917435`*^9, 
   3.796568016212229*^9}, {3.7965680522695312`*^9, 3.7965680654521627`*^9}, {
   3.7965681362488194`*^9, 3.796568156941971*^9}, {3.7965682189157047`*^9, 
   3.7965682858518553`*^9}, {3.7965683262617607`*^9, 
   3.7965683511302958`*^9}, {3.7965685107329674`*^9, 
   3.7965685335923696`*^9}, {3.796568569834775*^9, 3.7965685790882106`*^9}, {
   3.79657628809023*^9, 3.7965767643981304`*^9}, {3.7965768281684465`*^9, 
   3.7965768308117733`*^9}, {3.796576927499774*^9, 3.7965770436816406`*^9}, {
   3.796577126453221*^9, 3.796577153730579*^9}, 3.7965773050585785`*^9, {
   3.7965773886059427`*^9, 3.7965774007441263`*^9}, {3.7967156446190634`*^9, 
   3.7967156487262297`*^9}, {3.7967156850764585`*^9, 3.796715853108943*^9}, {
   3.7967159126382847`*^9, 3.7967159561160955`*^9}, {3.7967160082479305`*^9, 
   3.7967160465390224`*^9}, {3.7967161610944815`*^9, 3.796716287615986*^9}, {
   3.796716347356275*^9, 3.79671634944248*^9}, {3.7967165118908887`*^9, 
   3.7967165185385137`*^9}, {3.796716553684307*^9, 3.796716602589198*^9}, {
   3.796716635343088*^9, 3.7967166431203833`*^9}, {3.7967167056706443`*^9, 
   3.796716712952591*^9}, {3.7967168393850913`*^9, 3.7967168527830086`*^9}, {
   3.7967245038981915`*^9, 3.796724508138928*^9}, {3.796724754514303*^9, 
   3.796724798348118*^9}, {3.796724864181119*^9, 3.7967249093314137`*^9}, {
   3.7967250375576124`*^9, 3.796725082279054*^9}, {3.796725131095547*^9, 
   3.796725134282059*^9}, {3.7967251675999594`*^9, 3.796725169429067*^9}, {
   3.7967252572443*^9, 3.7967252845054216`*^9}, {3.796725354874297*^9, 
   3.7967254149287453`*^9}, {3.796725468541444*^9, 3.79672551857586*^9}, 
   3.7967255490274096`*^9, {3.7967255821977663`*^9, 3.796725673875806*^9}, {
   3.7967257055142255`*^9, 3.7967257076295705`*^9}, {3.7967257497998333`*^9, 
   3.7967257716723948`*^9}, {3.796741574824272*^9, 3.7967415758965683`*^9}, {
   3.7967417648621335`*^9, 3.796741778137867*^9}, {3.7967424995620813`*^9, 
   3.7967426666377435`*^9}, {3.799143946588016*^9, 3.799143953697977*^9}, {
   3.7991457143992834`*^9, 3.7991457219543395`*^9}, {3.799145758908003*^9, 
   3.799145784855301*^9}, {3.799146068542654*^9, 3.799146070462747*^9}, {
   3.7991461850371227`*^9, 3.799146195192695*^9}, {3.7991467047211885`*^9, 
   3.7991467641486254`*^9}, {3.7991469761706047`*^9, 3.799147007213108*^9}, {
   3.7991470746979733`*^9, 3.7991470853502493`*^9}, {3.799147170610553*^9, 
   3.7991471794402*^9}, {3.79914721438395*^9, 3.7991472155870457`*^9}, {
   3.7991472605608454`*^9, 3.7991472627785106`*^9}, {3.799147542663167*^9, 
   3.7991475469546947`*^9}, {3.79914815357452*^9, 3.7991481777260613`*^9}, {
   3.799148225886284*^9, 3.799148228182393*^9}, {3.799148275890798*^9, 
   3.7991482986100235`*^9}, {3.799148424059558*^9, 3.799148529564182*^9}, {
   3.7991487099980392`*^9, 3.7991487123581233`*^9}, {3.7991495029719276`*^9, 
   3.7991495344651423`*^9}, {3.7991495756992235`*^9, 
   3.7991495763256483`*^9}, {3.7991496992492657`*^9, 
   3.7991497313629026`*^9}, {3.7991498003518653`*^9, 
   3.7991498345570416`*^9}, {3.799149880469285*^9, 3.799149880595907*^9}, 
   3.7992174854686775`*^9, {3.799217606084168*^9, 3.7992176290675125`*^9}, {
   3.799217668858553*^9, 3.7992177079591017`*^9}, {3.7992177835892053`*^9, 
   3.7992177942086325`*^9}, {3.799217828529483*^9, 3.7992178627651443`*^9}, {
   3.799217921309703*^9, 3.79921797299146*^9}, {3.7992181195054183`*^9, 
   3.7992181862684565`*^9}, {3.7992183578840103`*^9, 3.79921837109896*^9}, {
   3.799218546052446*^9, 3.7992186395497417`*^9}, 3.799219032843584*^9, {
   3.79921913538864*^9, 3.7992191730826135`*^9}, {3.7992197023077855`*^9, 
   3.7992198079642963`*^9}, {3.7992213893038387`*^9, 
   3.7992213972371655`*^9}, {3.799221478930035*^9, 3.799221509667467*^9}, {
   3.7992215426633883`*^9, 3.799221542679344*^9}, {3.7992215739062104`*^9, 
   3.7992215739650536`*^9}, {3.799222106900366*^9, 3.7992221209520655`*^9}, {
   3.7992225960236025`*^9, 3.7992226311920805`*^9}, {3.7992226793731003`*^9, 
   3.799222683160578*^9}, {3.799222741171607*^9, 3.7992227415225983`*^9}, {
   3.79922286500375*^9, 3.7992229057168617`*^9}, {3.7992229475840135`*^9, 
   3.799222981147301*^9}, {3.7992230281872864`*^9, 3.79922302897917*^9}, {
   3.799223075493498*^9, 3.7992231695498962`*^9}, {3.7992232129372663`*^9, 
   3.799223354025659*^9}, {3.799223386955127*^9, 3.799223391148628*^9}, {
   3.7994127061206055`*^9, 
   3.7994127074080095`*^9}},ExpressionUUID->"85b0f4a0-33e3-4b95-8048-\
a1050848ba87"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", ",", "q"}], "}"}], "=", 
   RowBox[{"RandomPrime", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "^", "100"}], ",", 
       RowBox[{"2", "^", "101"}]}], "}"}], ",", "2"}], "]"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{
   "generate", " ", "2", " ", "random", " ", "prime", " ", "numbers"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"p", "\[Equal]", "q"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "q"}], "}"}], "=", 
     RowBox[{"RandomPrime", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "^", "100"}], ",", 
         RowBox[{"2", "^", "101"}]}], "}"}], ",", "2"}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"p", ",", "q"}], "}"}]}], "Input",
 CellChangeTimes->{{3.7964679394803686`*^9, 3.7964679563592997`*^9}, {
   3.7964680223155355`*^9, 3.7964680258213167`*^9}, {3.7964680739050293`*^9, 
   3.7964680780023437`*^9}, {3.7964682061197248`*^9, 
   3.7964682116546793`*^9}, {3.796468948587016*^9, 3.796468952300641*^9}, {
   3.7964690553438253`*^9, 3.7964690581433644`*^9}, {3.7964695916309547`*^9, 
   3.796469645511253*^9}, {3.796469697889789*^9, 3.796469721975541*^9}, {
   3.796469763436575*^9, 3.796469806607646*^9}, {3.796470546532261*^9, 
   3.7964705494411993`*^9}, {3.7965770673712177`*^9, 3.796577075490939*^9}, {
   3.796577436076317*^9, 3.7965774522283363`*^9}, {3.796577531663793*^9, 
   3.7965776458308725`*^9}, {3.796715488990891*^9, 3.796715490639496*^9}, {
   3.796716377350088*^9, 3.7967163787603135`*^9}, {3.796716417775476*^9, 
   3.7967164457910175`*^9}, {3.796716525497257*^9, 3.7967165347737823`*^9}, 
   3.7967166835111866`*^9, 3.7967167277316427`*^9, 3.7967168035985413`*^9, {
   3.7967169186682544`*^9, 3.7967169188527694`*^9}, {3.796724560400414*^9, 
   3.7967245669386907`*^9}, {3.79672513907123*^9, 3.796725141829851*^9}, {
   3.796741048789193*^9, 3.796741066887558*^9}, {3.79674183581002*^9, 
   3.796741897188184*^9}, {3.7967419322719173`*^9, 3.7967419357984886`*^9}, {
   3.796742026402524*^9, 3.7967420287986374`*^9}, {3.7967420783164215`*^9, 
   3.796742082342733*^9}, {3.7967421420849175`*^9, 3.7967421542051387`*^9}, {
   3.7967422325484285`*^9, 3.796742236061468*^9}, {3.7967423128514657`*^9, 
   3.7967423361921988`*^9}, {3.7967423670551004`*^9, 
   3.7967423700819592`*^9}, {3.7967426794719596`*^9, 3.796742688935376*^9}, {
   3.799143970934902*^9, 3.799143988632633*^9}, {3.799146235259986*^9, 
   3.7991462377283*^9}, {3.7991498633294077`*^9, 3.7991498664920425`*^9}, {
   3.7992233988836803`*^9, 3.799223435821791*^9}, {3.7992241194782305`*^9, 
   3.7992241263239617`*^9}, {3.7992242826889906`*^9, 
   3.7992243206325407`*^9}, {3.799412450431734*^9, 3.7994124670482836`*^9}, {
   3.799412534972948*^9, 3.7994125397285914`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"2b4c480c-e41e-43d7-86c2-6175c89e297b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2333996989431797266766653971667", ",", "1992437641569048074752293766771"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.796716693919804*^9, {3.796716728509525*^9, 3.7967167734271517`*^9}, {
   3.796716804327508*^9, 3.7967168143600307`*^9}, {3.796716858486788*^9, 
   3.7967169595596437`*^9}, {3.7967245530959525`*^9, 3.796724568850148*^9}, 
   3.7967249453072376`*^9, 3.7967251420862265`*^9, 3.796725172832969*^9, 
   3.796725421055368*^9, 3.7967255039339886`*^9, {3.7967410527419963`*^9, 
   3.7967410671618233`*^9}, 3.796741800585905*^9, {3.796741842293062*^9, 
   3.7967418974843907`*^9}, 3.7967419362760324`*^9, 3.7967420293502045`*^9, 
   3.7967420830881295`*^9, {3.7967421434926043`*^9, 3.7967421545054083`*^9}, 
   3.7967422364873295`*^9, {3.7967423154760795`*^9, 3.7967423366098237`*^9}, 
   3.7967423705616713`*^9, 3.7967426892395296`*^9, 3.7991438295707755`*^9, {
   3.7991439567607894`*^9, 3.7991439889009104`*^9}, {3.7991462301856923`*^9, 
   3.799146246512723*^9}, {3.7991471018575387`*^9, 3.799147103932294*^9}, 
   3.799149866768196*^9, 3.799220605126423*^9, 3.799222917464822*^9, 
   3.799223188395568*^9, {3.799223394050598*^9, 3.799223436373369*^9}, {
   3.7992242946340265`*^9, 3.7992243209288044`*^9}, {3.799412459896381*^9, 
   3.799412478290202*^9}, 3.7994125427548547`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"0c3f04e9-cac0-4f44-abe7-7aea056e6dff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "@", 
  RowBox[{"PPSO", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "4", ",", "5", ",", "3", ",", "1", ",", "1", ",", 
        "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "3", ",", "1", ",", "6", ",", "8", ",", "4", ",", "3", ",", 
        "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "5", ",", "4", ",", "1", ",", "3", ",", "1", ",", "9", ",", "3", ",", 
        "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "4", ",", "3", ",", "1", ",", "1", ",", "8", ",", "9", ",", "3", ",", 
        "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "3", ",", "1", ",", "5", ",", "1", ",", "9", ",", "3", ",", "9", ",", 
        "4"}], "}"}]}], "}"}], ",", "p", ",", "q", ",", "6"}], "]"}], " ", 
  RowBox[{"(*", "Teste", "*)"}]}]], "Input",
 CellChangeTimes->{{3.79631005742352*^9, 3.7963100687292757`*^9}, {
   3.7963101110611544`*^9, 3.7963101316461883`*^9}, {3.796312079020105*^9, 
   3.796312083231989*^9}, {3.7963121919038115`*^9, 3.7963121919626427`*^9}, {
   3.7963661749970083`*^9, 3.7963661753909836`*^9}, {3.7963819478596964`*^9, 
   3.7963819609863596`*^9}, {3.7963820097644567`*^9, 
   3.7963820099190397`*^9}, {3.7963929276856885`*^9, 3.796392927973922*^9}, {
   3.796393044047919*^9, 3.796393046586135*^9}, {3.7963931603182645`*^9, 
   3.7963932002495527`*^9}, {3.796394385177661*^9, 3.79639438978937*^9}, {
   3.7963961671010838`*^9, 3.796396177890216*^9}, {3.796396398991393*^9, 
   3.796396399260709*^9}, {3.7964098012736855`*^9, 3.796409802784683*^9}, 
   3.796448104116353*^9, {3.796463660972986*^9, 3.7964636716010513`*^9}, {
   3.7964638414858093`*^9, 3.7964638490119042`*^9}, {3.7964639727770634`*^9, 
   3.796463977985176*^9}, {3.7964676309255524`*^9, 3.796467631435897*^9}, {
   3.7964679025996733`*^9, 3.796467905101432*^9}, {3.796468998457802*^9, 
   3.7964690147015934`*^9}, {3.796469558312813*^9, 3.796469577714075*^9}, {
   3.7964696538758745`*^9, 3.7964696894468803`*^9}, {3.7964697819684935`*^9, 
   3.7964697849020925`*^9}, {3.796566682739749*^9, 3.796566682811515*^9}, {
   3.796577183110856*^9, 3.7965772006402817`*^9}, {3.796577416225992*^9, 
   3.796577425433799*^9}, {3.796577689202583*^9, 3.7965776909818726`*^9}, {
   3.796715505984023*^9, 3.796715625432219*^9}, 3.7967166757668543`*^9, 
   3.796716798182891*^9, 3.796716896070459*^9, {3.796716951017036*^9, 
   3.796716956683447*^9}, {3.7967245820822845`*^9, 3.796724610355698*^9}, {
   3.796724656346746*^9, 3.7967246563776627`*^9}, {3.7967251075265627`*^9, 
   3.7967251084570737`*^9}, {3.7967251887544036`*^9, 3.796725190784977*^9}, {
   3.796725291460827*^9, 3.796725291608431*^9}, {3.796725524058196*^9, 
   3.796725563045932*^9}, {3.7967257569946012`*^9, 3.7967258016592255`*^9}, {
   3.7967408503307796`*^9, 3.7967408956669765`*^9}, {3.79674094735137*^9, 
   3.796740949012408*^9}, {3.799149554659561*^9, 3.7991495552051983`*^9}, {
   3.7992206205748653`*^9, 3.7992206317669864`*^9}, {3.7992229340855513`*^9, 
   3.7992229359038877`*^9}, {3.7992231911068387`*^9, 
   3.7992231927613463`*^9}, {3.799412554501732*^9, 3.7994125700878*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"4c839d6e-a44b-430a-8018-b9c8c5571e2d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.203125`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "3", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "1", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "1", ",", "3", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "3", ",", "1", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "1", ",", "3", ",", "4"}], "}"}]}], "}"}]}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.7964679064781218`*^9, 3.796467959649194*^9, 3.7964680415596933`*^9, 
   3.796468164804744*^9, 3.7964683123646784`*^9, {3.796468992356572*^9, 
   3.7964690776476064`*^9}, {3.796469542095678*^9, 3.7964697856698093`*^9}, 
   3.796470613437477*^9, 3.7964722628693867`*^9, 3.7965666453875513`*^9, 
   3.7965667073279743`*^9, {3.7965770641428504`*^9, 3.79657707845191*^9}, {
   3.796577166624196*^9, 3.7965772011582303`*^9}, {3.796577310927723*^9, 
   3.796577321837347*^9}, {3.796577406799468*^9, 3.7965774633470297`*^9}, 
   3.796577691648059*^9, {3.7967155173925943`*^9, 3.796715591522699*^9}, 
   3.79671562912426*^9, 3.796716302936346*^9, 3.796716385329875*^9, 
   3.7967164426363883`*^9, 3.7967165039447412`*^9, 3.7967165392604733`*^9, {
   3.7967166655485387`*^9, 3.796716776220865*^9}, {3.796716807641039*^9, 
   3.7967168167005043`*^9}, {3.79671687196109*^9, 3.7967168917440543`*^9}, {
   3.7967169467202945`*^9, 3.796716960924131*^9}, {3.796724578701705*^9, 
   3.7967246188110933`*^9}, 3.7967246657555933`*^9, 3.7967249564255123`*^9, {
   3.7967251157615433`*^9, 3.796725144323185*^9}, {3.7967251745134735`*^9, 
   3.796725191428261*^9}, {3.7967252885256786`*^9, 3.7967252921230555`*^9}, 
   3.7967253285726104`*^9, 3.7967254229283595`*^9, {3.796725505791994*^9, 
   3.7967255392216225`*^9}, 3.7967255952210836`*^9, {3.796725631490122*^9, 
   3.7967256776586943`*^9}, 3.796725711784462*^9, {3.7967257594919195`*^9, 
   3.796725805455042*^9}, {3.7967408514004297`*^9, 3.7967409498122663`*^9}, {
   3.7967410585659437`*^9, 3.796741063411532*^9}, 3.7967411028120017`*^9, 
   3.7967413031959286`*^9, {3.7967417823805656`*^9, 3.796741802481535*^9}, {
   3.7967418446349945`*^9, 3.7967418999378405`*^9}, 3.7967419786505365`*^9, 
   3.796742068695187*^9, {3.796742146392872*^9, 3.7967421593913994`*^9}, 
   3.7967422467324705`*^9, {3.7967423223956814`*^9, 3.796742342901553*^9}, 
   3.7967423776520157`*^9, 3.7967426923000593`*^9, 3.799143831408862*^9, {
   3.799143958069291*^9, 3.7991439905345087`*^9}, {3.799145770319491*^9, 
   3.799145787631049*^9}, 3.7991460731760674`*^9, {3.7991462310662756`*^9, 
   3.7991462628427916`*^9}, 3.7991471063053923`*^9, {3.799147242845147*^9, 
   3.7991472677133584`*^9}, 3.799147553862899*^9, {3.7991481442218914`*^9, 
   3.7991481712147694`*^9}, 3.7991482386482997`*^9, 3.7991484357431145`*^9, {
   3.7991484819906673`*^9, 3.7991485325302143`*^9}, {3.799149539881263*^9, 
   3.799149581657748*^9}, {3.7991498136271048`*^9, 3.7991498963176203`*^9}, {
   3.7992206086793127`*^9, 3.7992206324517326`*^9}, {3.7992229208071527`*^9, 
   3.799222984198188*^9}, 3.799223033279893*^9, {3.799223175237834*^9, 
   3.7992232026002274`*^9}, {3.799223396184702*^9, 3.7992234413218603`*^9}, {
   3.7992243095012856`*^9, 3.7992243236086116`*^9}, {3.799412529490183*^9, 
   3.7994125716363115`*^9}},
 CellLabel->"Out[21]=",ExpressionUUID->"dbf4b5d7-4c37-4e77-90f1-57e9c1a093c0"]
}, Open  ]]
},
WindowSize->{1141.2, 582.6},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"12a48924-0d96-4191-b0d8-74a983b8f735"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3274, 85, 379, "Input",ExpressionUUID->"8b1b0b23-2e0d-44c4-a31e-096b9cda444f"],
Cell[3835, 107, 7285, 165, 599, "Input",ExpressionUUID->"9300f5ee-0bd5-47c4-9e96-139677f1a78b"],
Cell[11123, 274, 25636, 533, 1772, "Input",ExpressionUUID->"85b0f4a0-33e3-4b95-8048-a1050848ba87"],
Cell[CellGroupData[{
Cell[36784, 811, 2985, 58, 101, "Input",ExpressionUUID->"2b4c480c-e41e-43d7-86c2-6175c89e297b"],
Cell[39772, 871, 1419, 22, 32, "Output",ExpressionUUID->"0c3f04e9-cac0-4f44-abe7-7aea056e6dff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41228, 898, 3281, 58, 65, "Input",ExpressionUUID->"4c839d6e-a44b-430a-8018-b9c8c5571e2d"],
Cell[44512, 958, 3501, 55, 32, "Output",ExpressionUUID->"dbf4b5d7-4c37-4e77-90f1-57e9c1a093c0"]
}, Open  ]]
}
]
*)

